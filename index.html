<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liberty Bordados | Fabricação Própria</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#042353',
                            light: '#eae7e4',
                            orange: '#f26522',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'dash': 'dash 20s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        dash: {
                            to: { strokeDashoffset: '1000' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #042353;
            color: #eae7e4;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #042353; }
        ::-webkit-scrollbar-thumb { background: #eae7e4; border-radius: 4px; }

        /* Correção: Classe hide-scroll adicionada */
        .hide-scroll {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .hide-scroll::-webkit-scrollbar {
            display: none; /* Chrome, Safari and Opera */
        }

        .glass-dark {
            background: rgba(4, 35, 83, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .btn-stitch {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .btn-stitch::before {
            content: '';
            position: absolute;
            top: 2px; left: 2px; right: 2px; bottom: 2px;
            border: 1px dashed rgba(242, 101, 34, 0);
            border-radius: inherit;
            transition: all 0.4s ease;
            pointer-events: none;
        }
        .btn-stitch:hover::before {
            border-color: rgba(242, 101, 34, 1);
            animation: dash 5s linear infinite reverse;
        }
        .btn-stitch:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        }

        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .modal {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }
        .modal.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            transform: scale(0.95) translateY(20px);
            transition: all 0.4s cubic-bezier(0.5, 0, 0, 1);
        }
        .modal.active .modal-content {
            transform: scale(1) translateY(0);
        }
    </style>
</head>
<body class="antialiased selection:bg-brand-orange selection:text-white relative">

    <section id="hero" class="min-h-screen flex flex-col justify-center items-center py-16 px-6 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10 pointer-events-none">
            <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                <path d="M-100,200 Q200,50 500,300 T1200,100" fill="none" stroke="#eae7e4" stroke-width="2" stroke-dasharray="10 15"/>
                <path d="M-100,500 Q300,700 700,400 T1500,600" fill="none" stroke="#f26522" stroke-width="1" stroke-dasharray="5 10"/>
            </svg>
        </div>

        <div class="max-w-2xl w-full text-center z-10 reveal">
            <div class="mb-10 animate-float flex justify-center w-full max-w-[280px] md:max-w-md mx-auto">
                 <img src="https://hcdsbawdwzmlujxnxymf.supabase.co/storage/v1/object/public/video%20lp1/download-removebg-preview.png" alt="Liberty Bordados" class="w-full h-auto object-contain drop-shadow-[0_10px_25px_rgba(0,0,0,0.5)]">
            </div>

            <p class="text-lg md:text-xl font-light mb-10 text-brand-light/80 max-w-lg mx-auto">
                Bordados de alta qualidade com tecnologia e precisão. Conecte-se conosco.
            </p>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-xl mx-auto">
                <button onclick="toggleCatalog()" class="sm:col-span-2 btn-stitch bg-brand-orange text-white py-4 px-6 rounded-2xl flex items-center justify-center gap-3 font-bold text-lg hover:bg-[#e05a1b] transition-colors shadow-lg shadow-brand-orange/20">
                    <i class="ph-fill ph-book-open-text text-2xl"></i>
                    Ver Todos Produtos
                </button>

                <a href="https://wa.me/seunumerodetelefone" target="_blank" class="btn-stitch bg-white text-brand-blue py-4 px-6 rounded-2xl flex items-center justify-center gap-3 font-semibold hover:bg-gray-100 transition-colors">
                    <i class="ph-fill ph-whatsapp-logo text-2xl text-green-500"></i>
                    Compre no Atacado
                </a>

                <a href="#" target="_blank" class="btn-stitch bg-white text-brand-blue py-4 px-6 rounded-2xl flex items-center justify-center gap-3 font-semibold hover:bg-gray-100 transition-colors">
                    <i class="ph-fill ph-tiktok-logo text-2xl text-black"></i>
                    Compre no TikTok
                </a>

                <a href="#" target="_blank" class="btn-stitch bg-white text-brand-blue py-4 px-6 rounded-2xl flex items-center justify-center gap-3 font-semibold hover:bg-gray-100 transition-colors">
                    <i class="ph-fill ph-handshake text-2xl text-yellow-500"></i>
                    Compre o Mercado Livre
                </a>

                <a href="#" target="_blank" class="btn-stitch bg-white text-brand-blue py-4 px-6 rounded-2xl flex items-center justify-center gap-3 font-semibold hover:bg-gray-100 transition-colors">
                    <i class="ph-fill ph-shopping-bag text-2xl text-brand-orange"></i>
                    Compre na Shopee
                </a>
            </div>
        </div>
    </section>

    <section id="about" class="py-24 px-6 bg-[#031c42] relative">
        <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
            <div class="order-2 md:order-1 reveal relative">
                <div class="relative rounded-3xl overflow-hidden aspect-square md:aspect-[4/5] shadow-2xl">
                    <div class="absolute inset-0 bg-brand-blue mix-blend-overlay opacity-20 z-10"></div>
                    <img src="https://hcdsbawdwzmlujxnxymf.supabase.co/storage/v1/object/public/video%20lp1/Gemini_Generated_Image_q2pdseq2pdseq2pd.png" alt="Máquinas de Bordado" class="w-full h-full object-cover">
                </div>
                <div class="absolute -bottom-6 -right-6 w-32 h-32 bg-brand-orange rounded-full mix-blend-multiply blur-2xl opacity-40 z-0"></div>
            </div>
            
            <div class="order-1 md:order-2 reveal">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 text-brand-orange text-sm font-bold tracking-widest uppercase mb-6">
                    <i class="ph-fill ph-needle"></i> Tradição e Tecnologia
                </div>
                <h2 class="font-heading text-4xl md:text-5xl font-black mb-6 leading-tight text-white">
                    Fabricação <span class="text-brand-orange">Própria.</span><br>Qualidade Absoluta.
                </h2>
                <p class="text-lg text-brand-light/80 mb-6 leading-relaxed">
                    Na Liberty Bordados, cada fio conta uma história. Combinamos a precisão das mais modernas máquinas industriais com o cuidado do acabamento artesanal. 
                </p>
                <p class="text-lg text-brand-light/80 mb-8 leading-relaxed">
                    Nossa estrutura permite atender de pequenos pedidos a grandes produções corporativas, garantindo que a sua marca seja representada com a máxima excelência.
                </p>
                
                <ul class="space-y-4 font-medium text-brand-light">
                    <li class="flex items-center gap-3"><i class="ph-fill ph-check-circle text-brand-orange text-xl"></i> Fios de alta durabilidade</li>
                    <li class="flex items-center gap-3"><i class="ph-fill ph-check-circle text-brand-orange text-xl"></i> Maquinário de última geração</li>
                    <li class="flex items-center gap-3"><i class="ph-fill ph-check-circle text-brand-orange text-xl"></i> Controle de qualidade rigoroso</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="location" class="py-24 px-6 bg-brand-blue text-brand-light relative overflow-hidden">
        <div class="max-w-6xl mx-auto flex flex-col items-center text-center reveal">
            <h2 class="font-heading text-4xl md:text-5xl font-black mb-4 text-white">Onde nos <span class="text-brand-orange">Encontrar</span></h2>
            <p class="text-brand-light/70 max-w-2xl mb-12">
                Venha nos visitar e conhecer de perto nossa linha de produção e showroom de produtos finais.
            </p>

            <div class="w-full max-w-4xl bg-white/5 backdrop-blur-md border border-white/10 p-2 md:p-4 rounded-3xl shadow-2xl">
                <div class="w-full h-[400px] rounded-2xl overflow-hidden bg-brand-light relative">
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3657.1975766258416!2d-46.65649438440669!3d-23.561349567475146!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94ce59c8da0aa315%3A0xd59f9431f2c9776a!2sAv.%20Paulista%20-%20S%C3%A3o%20Paulo%2C%20SP!5e0!3m2!1spt-BR!2sbr!4v1679000000000!5m2!1spt-BR!2sbr" 
                        width="100%" height="100%" style="border:0; filter: grayscale(50%) contrast(1.2);" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>

            <div class="mt-8 flex flex-col md:flex-row gap-8 text-left max-w-4xl w-full justify-center">
                <div class="flex items-start gap-4">
                    <div class="bg-brand-orange/20 p-3 rounded-full text-brand-orange">
                        <i class="ph-fill ph-map-pin text-2xl"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-lg text-white">Endereço</h4>
                        <p class="text-brand-light/70">Rua Exemplo das Confecções, 123<br>Bairro Industrial - SP</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="bg-brand-orange/20 p-3 rounded-full text-brand-orange">
                        <i class="ph-fill ph-clock text-2xl"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-lg text-white">Horário de Funcionamento</h4>
                        <p class="text-brand-light/70">Segunda a Sexta: 08h às 18h<br>Sábado: 08h às 12h</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-[#010e22] text-brand-light/50 py-8 text-center text-sm">
        <p>© <span id="year"></span> Liberty Bordados. Todos os direitos reservados.</p>
    </footer>

    <div id="catalogModal" class="modal fixed inset-0 z-50 flex items-center justify-center">
        <div class="absolute inset-0 glass-dark" onclick="toggleCatalog()"></div>
        
        <div class="modal-content relative w-full h-full bg-brand-light flex flex-col overflow-hidden text-brand-blue">
            <div class="px-6 py-4 border-b border-brand-blue/10 flex justify-between items-center bg-white/50 backdrop-blur-md sticky top-0 z-10">
                <div class="flex items-center gap-4">
                    <button onclick="toggleCatalog()" class="p-2 bg-brand-blue/10 hover:bg-brand-blue/20 text-brand-blue rounded-full transition-colors">
                        <i class="ph ph-arrow-left text-xl"></i>
                    </button>
                    <h2 class="font-heading font-black text-2xl text-brand-blue flex items-center gap-2">
                        <i class="ph-fill ph-books text-brand-orange"></i> Catálogo
                    </h2>
                </div>
                <button onclick="toggleAdmin()" class="text-xs font-bold text-brand-blue hover:text-brand-orange transition-colors flex items-center gap-1 bg-white border border-brand-blue/10 px-4 py-2 rounded-full shadow-sm hover:shadow">
                    <i class="ph-fill ph-lock-key"></i> Admin
                </button>
            </div>

            <div id="category-filters" class="px-6 py-4 bg-brand-light flex gap-2 overflow-x-auto whitespace-nowrap hide-scroll"></div>

            <div class="p-6 overflow-y-auto flex-1 bg-brand-light" id="catalog-grid">
                <div class="text-center text-brand-blue/50 py-10 w-full col-span-full">Carregando catálogo...</div>
            </div>
        </div>
    </div>


    <div id="adminModal" class="modal fixed inset-0 z-[60] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="toggleAdmin()"></div>
        
        <div class="modal-content relative w-full max-w-md bg-white text-brand-blue rounded-3xl shadow-2xl overflow-hidden">
            <div class="bg-brand-blue text-white p-6 relative">
                <button onclick="toggleAdmin()" class="absolute top-4 right-4 text-white/50 hover:text-white">
                    <i class="ph ph-x text-xl"></i>
                </button>
                <h3 class="font-heading font-bold text-xl flex items-center gap-2">
                    <i class="ph-fill ph-lock-key"></i> Área Restrita
                </h3>
                <p class="text-sm text-white/70 mt-1">Gerenciamento do Catálogo</p>
            </div>

            <div id="admin-login-view" class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold text-brand-blue mb-1">Senha de Acesso</label>
                        <input type="password" id="admin-pass" placeholder="••••••••" class="w-full px-4 py-3 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none transition-colors">
                    </div>
                    <button onclick="loginAdmin()" class="w-full bg-brand-orange text-white py-3 rounded-xl font-bold hover:bg-[#e05a1b] transition-colors">Entrar</button>
                </div>
            </div>

            <div id="admin-dashboard-view" class="p-6 hidden h-[70vh] overflow-y-auto">
                <div class="flex gap-2 mb-6 border-b border-brand-blue/10 pb-2">
                    <button onclick="switchAdminTab('add')" id="tab-add" class="text-sm font-bold text-brand-blue border-b-2 border-brand-orange pb-1">Novo Produto</button>
                    <button onclick="switchAdminTab('manage')" id="tab-manage" class="text-sm font-bold text-brand-blue/50 hover:text-brand-blue pb-1">Gerenciar Catálogo</button>
                </div>

                <div id="admin-add-section">
                    <div class="mb-6 bg-brand-orange/10 p-4 rounded-xl border border-brand-orange/20">
                        <h5 class="text-xs font-bold text-[#d85619] mb-2">Adicionar Nova Categoria</h5>
                        <div class="flex gap-2">
                            <input type="text" id="nova-categoria-nome" placeholder="Ex: Jaquetas" class="w-full px-3 py-1.5 rounded-lg bg-white border border-transparent focus:border-brand-orange focus:outline-none text-sm">
                            <button onclick="adicionarCategoria()" class="bg-brand-orange text-white px-3 py-1.5 rounded-lg text-sm font-bold hover:bg-[#e05a1b] transition-colors">Criar</button>
                        </div>
                    </div>

                    <h4 class="font-bold text-brand-blue mb-4">Adicionar Novo Produto</h4>
                    <form id="productForm" onsubmit="handleProductSubmit(event)" class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-brand-blue mb-1">Nome do Produto</label>
                            <input type="text" id="prod-nome" required placeholder="Ex: Camisa Polo Bordada" class="w-full px-4 py-2 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none">
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-brand-blue mb-1">Categoria</label>
                            <select id="prod-categoria" required class="w-full px-4 py-2 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none"></select>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-brand-blue mb-1">Descrição</label>
                            <textarea id="prod-descricao" rows="2" placeholder="Breve descrição do produto..." class="w-full px-4 py-2 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none text-sm"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-brand-blue mb-1">Link da Foto (Google Drive ou URL)</label>
                            <input type="url" id="prod-foto" required placeholder="https://..." class="w-full px-4 py-2 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-brand-blue mb-1">Texto do Botão</label>
                            <input type="text" id="prod-btn-txt" required placeholder="Ex: Comprar no WhatsApp" value="Fazer Orçamento" class="w-full px-4 py-2 rounded-xl bg-brand-light border-2 border-transparent focus:border-brand-orange focus:outline-none">
                        </div>

                        <button type="submit" class="w-full bg-brand-orange text-white py-3 rounded-xl font-bold hover:bg-[#e05a1b] transition-colors mt-2">
                            <i class="ph-bold ph-plus"></i> Salvar Produto
                        </button>
                    </form>
                </div>

                <div id="admin-manage-section" class="hidden">
                    <h4 class="font-bold text-brand-blue mb-4">Categorias</h4>
                    <div id="admin-cat-list" class="space-y-2 mb-8"></div>

                    <h4 class="font-bold text-brand-blue mb-4">Produtos</h4>
                    <div id="admin-prod-list" class="space-y-2"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('year').innerText = new Date().getFullYear();

        // Configuração Supabase
        const supabaseUrl = 'https://hcdsbawdwzmlujxnxymf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhjZHNiYXdkd3ptbHVqeG54eW1mIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2OTgzMjksImV4cCI6MjA4NTI3NDMyOX0.wqZvGYlLeU-CIcikwKFauTCwmSH1VvJuVpccca3wpaU';
        const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

        // Arrays em memória
        let categoriesDB = [];
        let productsDB = [];
        let currentCategory = 'Todos';

        // --- FUNÇÃO PARA BUSCAR DADOS DO SUPABASE ---
        async function carregarDados() {
            try {
                // Traz Categorias
                const { data: categoriasData, error: catError } = await supabaseClient.from('categoria').select('*');
                if (catError) console.error("Erro ao carregar categorias:", catError.message);
                else categoriesDB = categoriasData || [];

                // Traz Produtos
                const { data: produtosData, error: prodError } = await supabaseClient.from('produto').select('*').order('id', { ascending: false });
                if (prodError) console.error("Erro ao carregar produtos:", prodError.message);
                else productsDB = produtosData || [];
                
            } catch (err) {
                console.error("Erro geral na requisição:", err);
            }
        }

        // --- LÓGICA DE INTERFACE: SCROLL ---
        function revealOnScroll() {
            var reveals = document.querySelectorAll('.reveal');
            for (var i = 0; i < reveals.length; i++) {
                var windowHeight = window.innerHeight;
                var elementTop = reveals[i].getBoundingClientRect().top;
                if (elementTop < windowHeight - 100) reveals[i].classList.add('active');
            }
        }
        window.addEventListener('scroll', revealOnScroll);
        revealOnScroll(); 

        // --- LÓGICA DO CATÁLOGO ---
        const modalCatalog = document.getElementById('catalogModal');
        const gridCatalog = document.getElementById('catalog-grid');

        async function toggleCatalog() {
            modalCatalog.classList.toggle('active');
            if(modalCatalog.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
                gridCatalog.innerHTML = `<div class="col-span-full text-center py-10 text-brand-blue/50">Carregando catálogo...</div>`;
                
                await carregarDados(); 
                
                renderCategoriesUI();
                renderCatalog();
            } else {
                document.body.style.overflow = 'auto';
            }
        }

        function setCategory(catName) {
            currentCategory = catName;
            renderCategoriesUI();
            renderCatalog();
        }

        function renderCategoriesUI() {
            const container = document.getElementById('category-filters');
            let html = `<button onclick="setCategory('Todos')" class="px-4 py-1.5 rounded-full text-sm font-semibold transition-colors ${currentCategory === 'Todos' ? 'bg-brand-blue text-white' : 'bg-white text-brand-blue border border-brand-blue/20 hover:border-brand-orange'}">Todos</button>`;
            
            categoriesDB.forEach(cat => {
                const isActive = currentCategory === cat.nome;
                html += `<button onclick="setCategory('${cat.nome}')" class="px-4 py-1.5 rounded-full text-sm font-semibold transition-colors ${isActive ? 'bg-brand-blue text-white' : 'bg-white text-brand-blue border border-brand-blue/20 hover:border-brand-orange'}">${cat.nome}</button>`;
            });
            container.innerHTML = html;
        }

        function renderCatalog() {
            let filteredProducts = productsDB;
            if(currentCategory !== 'Todos') {
                filteredProducts = productsDB.filter(p => p.categoria === currentCategory);
            }

            if (filteredProducts.length === 0) {
                gridCatalog.innerHTML = `<div class="col-span-full text-center py-10 text-brand-blue/50">Nenhum produto encontrado nesta categoria.</div>`;
                return;
            }

            let html = `<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">`;
            
            filteredProducts.forEach(prod => {
                // CORREÇÃO: Tratamento de erros caso a imagem venha vazia do banco
                let imgUrl = prod.foto_url || '';
                
                if(imgUrl && typeof imgUrl === 'string' && imgUrl.includes("drive.google.com/file/d/")) {
                    try {
                        const partes = imgUrl.split('/d/');
                        if (partes.length > 1) {
                            const id = partes[1].split('/')[0];
                            imgUrl = `https://drive.google.com/uc?export=view&id=${id}`;
                        }
                    } catch (e) {
                        console.error("Erro ao converter link da imagem do produto: ", prod.nome);
                    }
                }

                const numeroWhats = "5511999999999"; 
                const msg = encodeURIComponent(`Olá! Tenho interesse no produto: ${prod.nome} da categoria ${prod.categoria}.`);
                const linkWhats = `https://wa.me/${numeroWhats}?text=${msg}`;

                html += `
                <div class="bg-white rounded-2xl p-3 shadow-lg hover:shadow-xl transition-shadow border border-brand-blue/5 flex flex-col group">
                    <div class="aspect-square rounded-xl overflow-hidden mb-4 bg-gray-100 relative">
                        <img src="${imgUrl}" alt="${prod.nome}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" onerror="this.src='https://via.placeholder.com/400?text=Sem+Foto'">
                        <div class="absolute top-2 right-2 bg-brand-light/90 backdrop-blur text-brand-blue text-xs font-bold px-2 py-1 rounded-full">
                            ${prod.categoria}
                        </div>
                    </div>
                    <h3 class="font-bold text-brand-blue text-lg mb-1 leading-tight">${prod.nome}</h3>
                    <p class="text-xs text-brand-blue/70 mb-3 line-clamp-2">${prod.descricao || ''}</p>
                    <div class="mt-auto pt-4">
                        <a href="${linkWhats}" target="_blank" class="w-full bg-brand-orange/10 text-brand-orange hover:bg-brand-orange hover:text-white transition-colors py-2 rounded-xl flex items-center justify-center gap-2 font-bold text-sm border border-brand-orange/20">
                            <i class="ph-fill ph-whatsapp-logo text-lg"></i>
                            ${prod.texto_botao || 'Fazer Orçamento'}
                        </a>
                    </div>
                </div>
                `;
            });
            html += `</div>`;
            gridCatalog.innerHTML = html;
        }

        // --- LÓGICA DA ÁREA ADMIN ---
        const modalAdmin = document.getElementById('adminModal');
        const viewLogin = document.getElementById('admin-login-view');
        const viewDash = document.getElementById('admin-dashboard-view');

        async function toggleAdmin() {
            modalAdmin.classList.toggle('active');
            if(!modalAdmin.classList.contains('active')) {
                document.getElementById('admin-pass').value = '';
            } else {
                if(!viewDash.classList.contains('hidden')) {
                    await carregarDados();
                    renderAdminSelectCategories();
                    renderManageLists();
                }
            }
        }

async function loginAdmin() {
    // 1. Você define o seu e-mail de admin fixo aqui:
    const emailAdminFixo = "admin@libertybordados.com.br"; // Use o e-mail que você cadastrou no Supabase
    
    // 2. Pega apenas a senha que você digitou na tela:
    const pass = document.getElementById('admin-pass').value;
    const btnLogin = document.getElementById('btn-login');

    if (!pass) {
        alert("Digite a senha!");
        return;
    }

    const textoOriginal = btnLogin.innerHTML;
    btnLogin.innerHTML = 'Verificando...';
    btnLogin.disabled = true;

    // 3. Envia o e-mail fixo + a senha digitada para o Supabase validar
    const { data, error } = await supabaseClient.auth.signInWithPassword({
        email: emailAdminFixo,
        password: pass,
    });

    btnLogin.innerHTML = textoOriginal;
    btnLogin.disabled = false;

    if (error) {
        alert('Senha incorreta!');
        document.getElementById('admin-pass').value = '';
    } else {
        // Sucesso! A senha bateu com o banco de dados
        document.getElementById('admin-login-view').classList.add('hidden');
        document.getElementById('admin-dashboard-view').classList.remove('hidden');
        document.getElementById('admin-pass').value = '';
        
        await carregarDados(); 
        renderAdminSelectCategories();
        renderManageLists();
    }
}

        function switchAdminTab(tab) {
            const btnAdd = document.getElementById('tab-add');
            const btnManage = document.getElementById('tab-manage');
            const secAdd = document.getElementById('admin-add-section');
            const secManage = document.getElementById('admin-manage-section');

            if(tab === 'add') {
                btnAdd.className = "text-sm font-bold text-brand-blue border-b-2 border-brand-orange pb-1";
                btnManage.className = "text-sm font-bold text-brand-blue/50 hover:text-brand-blue pb-1";
                secAdd.classList.remove('hidden');
                secManage.classList.add('hidden');
            } else {
                btnManage.className = "text-sm font-bold text-brand-blue border-b-2 border-brand-orange pb-1";
                btnAdd.className = "text-sm font-bold text-brand-blue/50 hover:text-brand-blue pb-1";
                secManage.classList.remove('hidden');
                secAdd.classList.add('hidden');
                renderManageLists();
            }
        }

        function renderAdminSelectCategories() {
            const select = document.getElementById('prod-categoria');
            select.innerHTML = '<option value="" disabled selected>Selecione uma categoria...</option>';
            categoriesDB.forEach(cat => {
                select.innerHTML += `<option value="${cat.nome}">${cat.nome}</option>`;
            });
        }

        function renderManageLists() {
            const catList = document.getElementById('admin-cat-list');
            catList.innerHTML = '';
            if(categoriesDB.length === 0) catList.innerHTML = '<span class="text-xs text-gray-400">Nenhuma categoria encontrada.</span>';
            categoriesDB.forEach(cat => {
                catList.innerHTML += `
                    <div class="flex justify-between items-center bg-brand-light/50 p-3 rounded-xl border border-brand-blue/5">
                        <span class="text-sm font-bold text-brand-blue">${cat.nome}</span>
                        <button onclick="deletarCategoria('${cat.id}')" class="text-red-500 hover:text-red-700 bg-red-100 p-2 rounded-lg transition-colors"><i class="ph ph-trash"></i></button>
                    </div>
                `;
            });

            const prodList = document.getElementById('admin-prod-list');
            prodList.innerHTML = '';
            if(productsDB.length === 0) prodList.innerHTML = '<span class="text-xs text-gray-400">Nenhum produto encontrado.</span>';
            productsDB.forEach(prod => {
                prodList.innerHTML += `
                    <div class="flex justify-between items-center bg-brand-light/50 p-3 rounded-xl border border-brand-blue/5">
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-brand-blue">${prod.nome}</span>
                            <span class="text-xs text-brand-blue/60">${prod.categoria}</span>
                        </div>
                        <button onclick="deletarProduto('${prod.id}')" class="text-red-500 hover:text-red-700 bg-red-100 p-2 rounded-lg transition-colors"><i class="ph ph-trash"></i></button>
                    </div>
                `;
            });
        }

        // --- CRUD NO SUPABASE ---

        async function adicionarCategoria() {
            const nomeInput = document.getElementById('nova-categoria-nome');
            const nome = nomeInput.value.trim();
            if(!nome) return;
            
            const { error } = await supabaseClient.from('categoria').insert([{ nome: nome }]);
            
            if (error) {
                console.error(error);
                alert('Erro ao salvar categoria: ' + error.message);
                return;
            }

            nomeInput.value = '';
            await carregarDados(); 
            renderAdminSelectCategories();
            renderManageLists();
            if(modalCatalog.classList.contains('active')) renderCategoriesUI();
        }

        async function deletarCategoria(id) {
            if(!confirm('Tem certeza que deseja deletar esta categoria?')) return;
            
            const { error } = await supabaseClient.from('categoria').delete().eq('id', id);
            
            if (error) {
                console.error(error);
                alert('Erro ao excluir: ' + error.message);
                return;
            }

            await carregarDados();
            renderAdminSelectCategories();
            renderManageLists();
            if(modalCatalog.classList.contains('active')) renderCategoriesUI();
        }

        async function handleProductSubmit(e) {
            e.preventDefault();
            
            const btnSubmit = e.target.querySelector('button[type="submit"]');
            const textoOriginal = btnSubmit.innerHTML;
            btnSubmit.innerHTML = 'Salvando...';
            btnSubmit.disabled = true;

            const novoProduto = {
                nome: document.getElementById('prod-nome').value,
                descricao: document.getElementById('prod-descricao').value,
                categoria: document.getElementById('prod-categoria').value,
                foto_url: document.getElementById('prod-foto').value,
                texto_botao: document.getElementById('prod-btn-txt').value
            };

            const { error } = await supabaseClient.from('produto').insert([novoProduto]);
            
            btnSubmit.innerHTML = textoOriginal;
            btnSubmit.disabled = false;

            if(error) {
                console.error(error);
                alert('Erro ao salvar no banco: ' + error.message);
                return;
            }

            alert('Produto adicionado com sucesso!');
            document.getElementById('productForm').reset();
            
            await carregarDados();
            switchAdminTab('manage'); 
            
            if(modalCatalog.classList.contains('active')) {
                renderCategoriesUI();
                renderCatalog();
            }
        }

        async function deletarProduto(id) {
            if(!confirm('Tem certeza que deseja deletar este produto?')) return;
            
            const { error } = await supabaseClient.from('produto').delete().eq('id', id);
            
            if (error) {
                console.error(error);
                alert('Erro ao excluir: ' + error.message);
                return;
            }

            await carregarDados();
            renderManageLists();
            if(modalCatalog.classList.contains('active')) renderCatalog();
        }

        carregarDados();
    </script>
</body>
</html>
